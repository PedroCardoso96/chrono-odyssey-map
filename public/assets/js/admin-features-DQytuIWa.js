import{u as E,j as e}from"./map-features-5uDcVtW_.js";import{r as n}from"./router-vendor-C0czNOpy.js";function M(){return{centerOnMarker:n.useCallback(c=>{window.dispatchEvent(new CustomEvent("centerOnMarker",{detail:c}))},[])}}const C=n.memo(()=>{const{pendingMarkers:o,approveMarker:c,rejectMarker:h}=E(),{centerOnMarker:u}=M(),[p,b]=n.useState(!0),[d,k]=n.useState(null),[x,j]=n.useState(new Set),m=n.useMemo(()=>o.reduce((a,s)=>{const r=s.author?.email||s.authorId||"desconhecido";return a[r]||(a[r]={user:{name:s.author?.name||"Usu√°rio Desconhecido",email:r,picture:s.author?.picture},markers:[]}),a[r].markers.push(s),a},{}),[o]);function f(a){const s=new Set(x);s.has(a)?s.delete(a):s.add(a),j(s)}function N(a){u({lat:a.lat,lng:a.lng,zoom:1,label:a.label})}async function g(a){try{await c(a)}catch(s){alert(`Erro ao aprovar marcador: ${s instanceof Error?s.message:"Erro desconhecido"}`)}}async function v(a){try{await h(a)}catch(s){alert(`Erro ao rejeitar marcador: ${s instanceof Error?s.message:"Erro desconhecido"}`)}}n.useEffect(()=>{b(!1)},[]);const y=o.length,i=Object.keys(m).length;return e.jsxs("div",{className:"p-2 bg-[#1a1a1a] text-gray-200 border-l border-[#3a3a3a] w-[280px] h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"mb-3 text-center border-b border-[#3a3a3a] pb-2",children:[e.jsxs("h2",{className:"text-lg font-bold",children:["Marcadores Pendentes (",y,")"]}),e.jsxs("p",{className:"text-xs text-gray-400",children:[i," usu√°rio",i!==1?"s":""]})]}),p?e.jsx("p",{className:"text-center py-4 text-gray-400",children:"Carregando..."}):d?e.jsx("p",{className:"text-red-400 text-center py-4",children:d}):i===0?e.jsx("p",{className:"text-gray-400 text-center py-4",children:"Nenhum marcador pendente"}):e.jsx("div",{className:"space-y-2",children:Object.entries(m).map(([a,s])=>{const r=x.has(a),w=s.markers.length;return e.jsxs("div",{className:"bg-[#2f2f2f] rounded border border-[#3a3a3a] overflow-hidden",children:[e.jsx("div",{className:"p-3 cursor-pointer hover:bg-[#3a3a3a] transition-colors duration-200 border-b border-[#3a3a3a]",onClick:()=>f(a),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[s.user.picture?e.jsx("img",{src:s.user.picture,alt:s.user.name,className:"w-6 h-6 rounded-full border border-[#3a3a3a]"}):e.jsx("div",{className:"w-6 h-6 rounded-full bg-[#4a4a4a] flex items-center justify-center text-xs",children:"üë§"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-200 truncate",children:s.user.email}),e.jsx("p",{className:"text-xs text-gray-400 truncate",children:s.user.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"bg-[#4a4a4a] text-white px-2 py-1 rounded-full text-xs font-semibold",children:w}),e.jsx("span",{className:`transform transition-transform duration-200 text-gray-400 ${r?"rotate-180":""}`,children:"‚ñº"})]})]})}),e.jsx("div",{className:`transition-all duration-300 ease-in-out overflow-hidden ${r?"max-h-[600px] opacity-100":"max-h-0 opacity-0"}`,children:e.jsx("div",{className:"space-y-2 p-2",children:s.markers.map(t=>e.jsxs("div",{className:"bg-[#1a1a1a] rounded p-2 border border-[#3a3a3a]",children:[e.jsx("div",{className:"text-sm space-y-1",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("strong",{className:"text-blue-400",children:"Tipo:"})," ",t.type]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("strong",{className:"text-green-400",children:"Label:"})," ",t.label]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{className:"text-yellow-400",children:"Posi√ß√£o:"})," ",t.lat.toFixed(2),", ",t.lng.toFixed(2)]})]}),e.jsx("button",{onClick:()=>N(t),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors",children:"üëÅÔ∏è Ver"})]})}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),g(Number(t.id))},className:"flex-1 bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded text-xs font-semibold transition-colors",children:"‚úÖ Aprovar"}),e.jsx("button",{onClick:l=>{l.stopPropagation(),v(Number(t.id))},className:"flex-1 bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-xs font-semibold transition-colors",children:"‚ùå Rejeitar"})]})]},t.id))})})]},a)})})]})});C.displayName="AdminPanel";export{C as A};
